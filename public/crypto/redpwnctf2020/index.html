<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>redpwnCTF 2020 Crypto | itsecgary</title>
<meta name="keywords" content="writeup, crypto, redpwnctf" />
<meta name="description" content="Writeups of crypto challenges for redpwnCTF 2020">
<meta name="author" content="Me">
<link rel="canonical" href="https://www.itsecgary.com/crypto/redpwnctf2020/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.aa57b3480a846a90232c79aec91bdc6d537a52da077078726a8191e8495673cb.css" integrity="sha256-qlezSAqEapAjLHmuyRvcbVN6UtoHcHhyaoGR6ElWc8s=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js" integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5&#43;kdJvBz5iKbt6B5PJI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://www.itsecgary.com/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://www.itsecgary.com/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://www.itsecgary.com/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://www.itsecgary.com/apple-touch-icon.png">
<link rel="mask-icon" href="https://www.itsecgary.com/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.85.0" />
<meta property="og:title" content="redpwnCTF 2020 Crypto" />
<meta property="og:description" content="Writeups of crypto challenges for redpwnCTF 2020" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.itsecgary.com/crypto/redpwnctf2020/" /><meta property="og:image" content="https://www.itsecgary.com/img/pic_itsecgary.png"/><meta property="article:section" content="crypto" />
<meta property="article:published_time" content="2020-06-29T14:16:00&#43;00:00" />
<meta property="article:modified_time" content="2020-06-29T14:16:00&#43;00:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://www.itsecgary.com/img/pic_itsecgary.png"/>

<meta name="twitter:title" content="redpwnCTF 2020 Crypto"/>
<meta name="twitter:description" content="Writeups of crypto challenges for redpwnCTF 2020"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Cryptoes",
      "item": "https://www.itsecgary.com/crypto/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "redpwnCTF 2020 Crypto",
      "item": "https://www.itsecgary.com/crypto/redpwnctf2020/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "redpwnCTF 2020 Crypto",
  "name": "redpwnCTF 2020 Crypto",
  "description": "Writeups of crypto challenges for redpwnCTF 2020",
  "keywords": [
    "writeup", "crypto", "redpwnctf"
  ],
  "articleBody": "pseudo-key Category: Crypto\nPoints: 341\nDescription:\n Keys are not always as they seem…\nNote: Make sure to wrap the plaintext with flag{} before you submit!\nAuthor: Boolean\nGiven: pseudo-key-output.txt \u0026\u0026 pseudo-key.py\n Writeup First thing I do here is look at the files given to us. Looks like we are given the ciphertext and some “pseudo-key”.\nCiphertext: z_jjaoo_rljlhr_gauf_twv_shaqzb_ljtyut Pseudo-key: iigesssaemk From the program itself, it looks like our ciphertext is encrypted with some key, but we are given the key encrypted with itself. Interesting…\n#!/usr/bin/env python3 from string import ascii_lowercase chr_to_num = {c: i for i, c in enumerate(ascii_lowercase)} num_to_chr = {i: c for i, c in enumerate(ascii_lowercase)} def encrypt(ptxt, key): ptxt = ptxt.lower() key = ''.join(key[i % len(key)] for i in range(len(ptxt))).lower() ctxt = '' for i in range(len(ptxt)): if ptxt[i] == '_': ctxt += '_' continue x = chr_to_num[ptxt[i]] y = chr_to_num[key[i]] ctxt += num_to_chr[(x + y) % 26] return ctxt with open('flag.txt') as f, open('key.txt') as k: flag = f.read() key = k.read() ptxt = flag[5:-1] ctxt = encrypt(ptxt,key) pseudo_key = encrypt(key,key) print('Ciphertext:',ctxt) print('Pseudo-key:',pseudo_key) The encryption method pretty much takes the alphabetical number value of each character of the “plaintext”, adds it to the alphabetical number value of the key and wraps it around if the sum is greater than 26.\nThis is where I was very twisted for a day or so. I overthought the hell out of this problem. We realized before that the key given to us is completely wrong and is just the result of encrypting the key with itself. I figured out that each of these characters in the key has a total of 2 possible values it could actually be.\nLet’s take a look at the possible values of all 26 chars in the alphabet:\na: (0 + 0) % 26 = 0 (a) b: (1 + 1) % 26 = 2 (c) c: (2 + 2) % 26 = 4 (e) ... ... m: (12 + 12) % 26 = 24 (y) n: (13 + 13) % 26 = 0 (a) o: (14 + 14) % 26 = 2 (c) p: (15 + 15) % 26 = 4 (e) We can see here that there are really only 13 possible characters that could be in the key. Let’s get each possibility for our characters.\ni = e | r i = e | r g = d | q e = c | p s = j | w s = j | w s = j | w a = a | n e = c | p m = g | t k = f | s Now, I’m not sure what other people had for their approach, but I straight-up iterated through all possible combinations of this key. There are 2^11 (2048) key possibilities. I wrote a script to do this for me and decrypt the flag as well. So, this will basically output 2048 different flag options. This is harder since I don’t have the “flag{}” wrapper here to help me, but oh well.\nScript:\ndef get_plain(ct, key): plain = '' key = ''.join(key[i % len(key)] for i in range(len(ct))) for i in range(len(ct)): if ct[i] == '_': plain += ct[i] continue c = ord(ct[i]) - 97 k = ord(key[i]) - 97 if c  k: plain += chr(c-k+97) elif c Probably a more efficient way of doing what I did, butttttt oh well.\nOutput: (count)\n$ python3 solve.py  output \u0026\u0026 wc -l output 2048 output Scrolling through the 2048 options, I could kind of tell what some of these words were going to be. I did a search on a pair of words to narrow down the options.\n$ cat output | grep \"i_guess\" i_guess_pfeudo_keyf_nre_pseudb_fecure i_guess_pfrudo_keyf_nee_pseudb_frcure i_guess_pseudo_keyf_tre_pseudb_secure i_guess_psrudo_keyf_tee_pseudb_srcure i_guess_cfeudo_keyf_nre_pseudb_fecure i_guess_cfrudo_keyf_nee_pseudb_frcure i_guess_cseudo_keyf_tre_pseudb_secure i_guess_csrudo_keyf_tee_pseudb_srcure i_guess_pfeudo_keys_nre_pseudo_fecure i_guess_pfrudo_keys_nee_pseudo_frcure i_guess_pseudo_keys_tre_pseudo_secure i_guess_psrudo_keys_tee_pseudo_srcure i_guess_cfeudo_keys_nre_pseudo_fecure i_guess_cfrudo_keys_nee_pseudo_frcure i_guess_cseudo_keys_tre_pseudo_secure i_guess_csrudo_keys_tee_pseudo_srcure i_guess_pfeuqo_keyf_nre_pseudb_fechre i_guess_pfruqo_keyf_nee_pseudb_frchre i_guess_pseuqo_keyf_tre_pseudb_sechre i_guess_psruqo_keyf_tee_pseudb_srchre i_guess_cfeuqo_keyf_nre_pseudb_fechre i_guess_cfruqo_keyf_nee_pseudb_frchre i_guess_cseuqo_keyf_tre_pseudb_sechre i_guess_csruqo_keyf_tee_pseudb_srchre i_guess_pfeuqo_keys_nre_pseudo_fechre i_guess_pfruqo_keys_nee_pseudo_frchre i_guess_pseuqo_keys_tre_pseudo_sechre i_guess_psruqo_keys_tee_pseudo_srchre i_guess_cfeuqo_keys_nre_pseudo_fechre i_guess_cfruqo_keys_nee_pseudo_frchre i_guess_cseuqo_keys_tre_pseudo_sechre i_guess_csruqo_keys_tee_pseudo_srchre I’m guessing my script had a tiny error with the “are” part of the flag, but it worked.\nFlag flag{i_guess_pseudo_keys_are_pseudo_secure}\n 4k-rsa Category: Crypto\nPoints: 389\nDescription:\n Only n00bz use 2048-bit RSA. True gamers use keys that are at least 4k bits long, no matter how many primes it takes…\nAuthor: Boolean\nGiven: 4k-rsa-public-key.txt\n Writeup Opening up the attachment given, we see we have a modulus (n), public exponent (e), and a ciphertext (c).\nn: 5028492424316659784848610571868499830635784588253436599431884204425304126574506051458282629520844349077718907065343861952658055912723193332988900049704385076586516440137002407618568563003151764276775720948938528351773075093802636408325577864234115127871390168096496816499360494036227508350983216047669122408034583867561383118909895952974973292619495653073541886055538702432092425858482003930575665792421982301721054750712657799039327522613062264704797422340254020326514065801221180376851065029216809710795296030568379075073865984532498070572310229403940699763425130520414160563102491810814915288755251220179858773367510455580835421154668619370583787024315600566549750956030977653030065606416521363336014610142446739352985652335981500656145027999377047563266566792989553932335258615049158885853966867137798471757467768769820421797075336546511982769835420524203920252434351263053140580327108189404503020910499228438500946012560331269890809392427093030932508389051070445428793625564099729529982492671019322403728879286539821165627370580739998221464217677185178817064155665872550466352067822943073454133105879256544996546945106521271564937390984619840428052621074566596529317714264401833493628083147272364024196348602285804117877 e: 65537 c: 3832859959626457027225709485375429656323178255126603075378663780948519393653566439532625900633433079271626752658882846798954519528892785678004898021308530304423348642816494504358742617536632005629162742485616912893249757928177819654147103963601401967984760746606313579479677305115496544265504651189209247851288266375913337224758155404252271964193376588771249685826128994580590505359435624950249807274946356672459398383788496965366601700031989073183091240557732312196619073008044278694422846488276936308964833729880247375177623028647353720525241938501891398515151145843765402243620785039625653437188509517271172952425644502621053148500664229099057389473617140142440892790010206026311228529465208203622927292280981837484316872937109663262395217006401614037278579063175500228717845448302693565927904414274956989419660185597039288048513697701561336476305496225188756278588808894723873597304279725821713301598203214138796642705887647813388102769640891356064278925539661743499697835930523006188666242622981619269625586780392541257657243483709067962183896469871277059132186393541650668579736405549322908665664807483683884964791989381083279779609467287234180135259393984011170607244611693425554675508988981095977187966503676074747171 The description provides us with a decent hint here. Saying that there are multiple primes involved probably means that n is made from more than just p and q!\nThere is a really nice website for factoring large n values. The website is called FactorDB and they have a python module for the website as well.\nPlugging our n in the website gives us a lot of primes, but the important thing here is that it is fully factored!\nResult: status (?)\tdigits\tnumber FF\t1225 (show)\t5028492424...77 = 9353689450544968301 · 9431486459129385713 · 9563871376496945939 · 9734621099746950389 · 9736426554597289187 · 10035211751896066517 · 10040518276351167659 · 10181432127731860643 · 10207091564737615283 · 10435329529687076341 · 10498390163702844413 · 10795203922067072869 · 11172074163972443279 · 11177660664692929397 · 11485099149552071347 · 11616532426455948319 · 11964233629849590781 · 11992188644420662609 · 12084363952563914161 · 12264277362666379411 · 12284357139600907033 · 12726850839407946047 · 13115347801685269351 · 13330028326583914849 · 13447718068162387333 · 13554661643603143669 · 13558122110214876367 · 13579057804448354623 · 13716062103239551021 · 13789440402687036193 · 13856162412093479449 · 13857614679626144761 · 14296909550165083981 · 14302754311314161101 · 14636284106789671351 · 14764546515788021591 · 14893589315557698913 · 15067220807972526163 · 15241351646164982941 · 15407706505172751449 · 15524931816063806341 · 15525253577632484267 · 15549005882626828981 · 15687871802768704433 · 15720375559558820789 · 15734713257994215871 · 15742065469952258753 · 15861836139507191959 · 16136191597900016651 · 16154675571631982029 · 16175693991682950929 · 16418126406213832189 · 16568399117655835211 · 16618761350345493811 · 16663643217910267123 · 16750888032920189263 · 16796967566363355967 · 16842398522466619901 · 17472599467110501143 · 17616950931512191043 · 17825248785173311981 · 18268960885156297373 · 18311624754015021467 · 18415126952549973977 This is easy from here on out. In order to find our private exponent (d), we need to find phi, which is the product of (every prime - 1). After finding phi, we can take the modular multiplicative inverse of e and phi to find d.\nNote: I didn’t feel like copying the 60-something primes into my script so I used the python module for FactorDB :)\nScript:\nimport gmpy from pwn import * from Crypto.Util.number import long_to_bytes import binascii from factordb.factordb import FactorDB n = int(open(\"n\", \"r\").read()) c = int(open(\"c\", \"r\").read()) e = 65537 f = FactorDB(n) f.connect() arr = f.get_factor_list() phi = 1 for a in arr: phi *= (a-1) d = gmpy.invert(e, phi) flag = long_to_bytes(pow(c,d,n)).decode() log.success(\"Flag: {}\".format(flag)) Output:\n$ python3 4k_rsa.py [+] Flag: flag{t0000_m4nyyyy_pr1m355555} Flag flag{t0000_m4nyyyy_pr1m355555}\nResources FactorDB\nRSA Info\n 12-shades-of-redpwn Category: Crypto\nPoints: 429\nDescription:\n Everyone’s favorite guess god Tux just sent me a flag that he somehow encrypted with a color wheel!\nI don’t even know where to start, the wheel looks more like a clock than a cipher… can you help me crack the code?\nAuthor: Boolean\nGiven: ciphertext.jpg \u0026\u0026 color-wheel.jpg\n Writeup This one took me a while to figure out for some reason (lol). The hint gave me the idea that the colors in the chart were corresponding to the numbers on the clock (1-12), but I was just a tiny bit wrong. The color wheel had values (0-11), but in hex obviously… (sarcasm). Here is my edited version:\nNow, with this and our ciphertext, we can start plugging and chugging values. Our result is the following:\n86 90 81 87 a3 49 99 43 97 97 41 92 49 7b 41 97 7b 44 92 7b 44 96 98 a5 Translating this from hex to ASCII, doesn’t give us anything but gunk…\n....¢I.C..A.I{A.{D.{D..¥ After a while of staring at this stupuid color wheel and hex values I derived from it, I started noticing that 86 90 81 87 represents flag and the a3 and a5 values are two apart (have to be curly braces). It finally hit me that this is in base12. This changes our ascii representation of these values:\n41 - 1 62 - J 83 - c a4 - | 42 - 2 63 - K 84 - d a5 - } 43 - 3 64 - L 85 - e 44 - 4 65 - M 86 - f 45 - 5 66 - N 87 - g 46 - 6 67 - O 88 - h 47 - 7 68 - P 89 - i 48 - 8 69 - Q 8a - j 49 - 9 6a - R 8b - k 4a - : 6b - S 90 - l 4b - ; 70 - T 91 - m 50 - U 92 - n 51 - = 72 - V 93 - o 52 -  73 - W 94 - p 53 - ? 74 - X 95 - q 54 - @ 75 - Y 96 - r 55 - A 76 - Z 97 - s 56 - B 77 - [ 98 - t 57 - C 78 - \\ 99 - u 58 - D 79 - ] 9a - v 59 - E 7a - ^ 9b - w 5a - F 7b - _ a0 - x 5b - G 80 - ' a1 - y 60 - H 81 - a a2 - z 61 - I 82 - b a3 - { Now decoding with our base12 ASCII representation gives us the flag.\nFlag flag{9u3ss1n9_1s_4n_4rt}\nResources ASCII Chart\n itsy-bitsy Category: Crypto\nPoints: 436\nDescription:\n The itsy-bitsy spider climbed up the water spout… nc 2020.redpwnc.tf 31284\nAuthor: Boolean\nGiven: itsy-bitsy.py\n Writeup This one was interesting. Don’t really think I took the right path on this one because I had to “guess” part of the flag, but you will see how I came to that. Why write this writeup then? Because it might have been a different approach to this problem and might be useful (maybe).\nAnyways, I ran the program to see what we are working with:\n$ nc 2020.redpwnc.tf 31284 Enter an integer i such that i  0: 2 Enter an integer j such that j  i  0: 3 Ciphertext: 0011011011001010101010101110000100000011100100010100001010101010000000111011010000100011010011100010001110100011001110011000100110110010111010010110100110001111010010100111000111010111100010101011101001000100110010000100110100101000011111001111110111000000000010010100001100100000010011110110010000010 I opened the script and analyzed the program. The general function of this program was to read in two integers, and output a binary ciphertext. One of the integers had to be bigger than the other one and they both had to be greater than 0.\n#!/usr/bin/env python3 from Crypto.Random.random import randint def str_to_bits(s): bit_str = '' for c in s: i = ord(c) bit_str += bin(i)[2:] return bit_str def recv_input(): i = input('Enter an integer i such that i  0: ') j = input('Enter an integer j such that j  i  0: ') try: i = int(i) j = int(j) if i This program reads in the flag server-side and encrypts it using our numbers we provided. The numbers we provided are put in the exponent of 2, making an upper-bound and a lower-bound. The length of the flag is passed in to make sure that they return the same number of bits as the flag. After generating a random bit pattern and converting the flag into bits, the program does an XOR with both bit streams. This is what we are seeing for the binary ciphertext given to us. Interesting…\nI made it certain in my head that there wasn’t really a way to get around the randomness of the generated bits (keep in mind I haven’t seen any other solutions before writing this). My approach was to take the smallest numbers I could do and generate cases for my ciphertext.\nIf I entered in a 1 and 2. The lower-bound would be 2^1 and the upper-bound would be (2^2) - 1. Making the randomly-generated bits to being either 10 or 11 (2 If I entered in a 2 and 3. The lower-bound would be 2^2 and the upper-bound would be (2^3) - 1. Making the randomly-generated bits to being either 100, 101, 110, or 111 (4 I started to see a pattern with this. If I chose the first option (1 and 2), every other bit would HAVE to be a 1. Well I guess that covers half of the bits. I wanted more coverage, so I got samples for (1,2), (2,3), (4,5), (6,7), (10,11), and (12,13). The only problem with this was all of the prime numbers wouldn’t be found (along with a few stragglers).\nScript:\nfrom pwn import * from sympy import * from binascii import * ctwo = \"0011011000011001101100001101000010010011010011100100101001011000100001011100100011110110100100010000111101000101011001011001000011010001101001010110100101001100100000010101000000010001000000011110011011100110100001010101100000101101011011011100000011010001000001110000011010010000000100010110110101000\" cthree = \"0111101111111100011110011100010100010111110000000110011110001100110010111111110010100011010111010010011100100111011100011000000100100010101100100010110110101001000110110101010011110101110110111001001101000100010100110000110100111110101011101111010011000110010010100000011000100000110011000100010000010\" cfive = \"0011100110010100100101000001110100101011011100110100001100001001000011001001101110111000010110010000110010110100011110101101000010000000111001110110100010100000110100110101101011100110000110010101000110000101010101100111101100000101001011101100000101010000111100000000011111111000011111110111101001000\" cseven = \"0110001010101000001000000110010000100011110111111010100100001010110010010111100001010001111010111000000000110000000101101101100010011001000001001000010110000011000100000111110011010100011100111100011010001010010110010000011101110100011011010100001010100110111010001001010100000001000001001000110010111\" celeven = \"0100110110100001101011011001111100100010010010010000000110011011110100010101101001000010100000000000110011111000111101101000010000000001011110111011000000000101000110011011100100101110011000010101101101101110100000101110101011101110010011000101001111011111000011000100100111110111000100000101010000100\" reconstructed = '' re_list = [] for i in range(len(ctwo)): if i % 2 == 0: val = int(ctwo[i]) reconstructed += \"0\" if val == 1 else \"1\" elif i % 3 == 0: val = int(cthree[i]) reconstructed += \"0\" if val == 1 else \"1\" elif i % 5 == 0: val = int(cfive[i]) reconstructed += \"0\" if val == 1 else \"1\" elif i % 7 == 0: val = int(cseven[i]) reconstructed += \"0\" if val == 1 else \"1\" elif i % 11 == 0: val = int(celeven[i]) reconstructed += \"0\" if val == 1 else \"1\" elif isprime(i): reconstructed += 'p' else: reconstructed += '?' if len(reconstructed) == 7: reconstructed = \"0\" + reconstructed re_list.append(reconstructed) reconstructed = '' print(re_list) vals = [\"0\", \"1\"] flag = [] one = [] two = [] three = [] four = [] for r in re_list: count = 0 for c in r: if c == \"?\" or c == \"p\": count += 1 if count == 0: one.append(r) two.append(r) three.append(r) four.append(r) elif count == 1: oned = r.replace(\"?\", \"0\").replace(\"p\", \"0\") twod = r.replace(\"?\", \"1\").replace(\"p\", \"1\") one.append(oned) two.append(twod) three.append(twod) four.append(oned) else: one.append(r.replace(\"p\", \"0\")) two.append(r.replace(\"p\", \"0\", 1).replace(\"p\", \"1\", 1)) three.append(r.replace(\"p\", \"1\", 1).replace(\"p\", \"0\", 1)) four.append(r.replace(\"p\", \"1\")) flag1 = [] for h in one: if \"?\" in h: flag1.append(\"?\") else: flag1.append(chr(int(str(h), 2))) flag2 = [] for h in two: if \"?\" in h: flag2.append(\"?\") else: flag2.append(chr(int(str(h), 2))) flag3 = [] for h in three: if \"?\" in h: flag3.append(\"?\") else: flag3.append(chr(int(str(h), 2))) flag4 = [] for h in four: if \"?\" in h: flag4.append(\"?\") else: flag4.append(chr(int(str(h), 2))) print(''.join(flag1)) print(''.join(flag2)) print(''.join(flag3)) print(''.join(flag4)) Yeah…. I probably could have reduced the repetitive code, but I really didn’t feel like doing it at the time. Looking back at this, I probably could have enumerated the options for the prime parts, but that is a lot of options.\nOutput:\n$ python3 itsy.py FlagSbIpq[DdajajG_MptKdn?j_`@e_?adE?]spkU?} fmcw[cKts_Leckcng_OqtOlo?k_dHe\\x7f?ctM?_wro]?\\x7f Fligsripy[dtajizG_mtt[d~?n_p`e_?ide?]sxku?} fmkw{skt{_luckk~g_out_l\\x7f?o_the\\x7f?ktm?_wzo}?\\x7f At this point, I recognized that I was pretty close. You can kind of see the flag forming. It was just a matter of those primes because they showed up in every byte.\nFrom here, all I really did was guess between the four options and see what looked and sounded like English (yikes). Not the most impressive route, but it got me there.\nFlag flag{bits_leaking_out_down_the_water_spout}\nPost Note Now I’m gonna go look at the other writeups for this challenge and realize how much time I probably wasted in this approach lol\n primimity Category: Crypto\nPoints: 450\nDescription:\n People claim that RSA with two 1024-bit primes is secure. But I trust no one. That’s why I use three 1024-bit primes.\nI even created my own prime generator to be extra cautious!\nAuthor: Boolean\nGiven: primimity.py \u0026\u0026 primimity-public-key.txt\n Writeup Looking at priminity.py, we see that the prime generation generates three primes: p, q, and r. It picks a random 1024-bit number, then finds the next prime - (d+1) primes away.\n#!/usr/bin/env python3 from Crypto.Util.number import getRandomNBitInteger, isPrime def find_next_prime(n): if n Running this program once, we get an example output of:\n$ python3 primimity.py 104857957995802113202799155043146383738317717869506487255733554982237834412439876073175028008556725572257508977034962752889399455584848024999705402597044673244677421623166376772490220536819588049922242374474030586464211019488836847121605902635938292012081202316987359553541112952345050585956025016297736305427 104857957995802113202799155043146383738317717869506487255733554982237834412439876073175028008556725572257508977034962752889399455584848024999705402597044673244677421623166376772490220536819588049922242374474030586464211019488836847121605902635938292012081202316987359553541112952345050585956025016297736436659 104857957995802113202799155043146383738317717869506487255733554982237834412439876073175028008556725572257508977034962752889399455584848024999705402597044673244677421623166376772490220536819588049922242374474030586464211019488836847121605902635938292012081202316987359553541112952345050585956025016297736606427 We can spot that the difference in the primes are very small (small enough to enumerate). Basiclaly, we are just exploiting this prime gap to find our p, q, and r.\nScript:\nfrom pwn import * import gmpy2 import gmpy from Crypto.Util.number import long_to_bytes n = int(open(\"n\", \"r\").read()) c = int(open(\"c\", \"r\").read()) e = 65537 root, extra = gmpy2.iroot(n,3) root = int(root) p = root while n % p != 0: p -= 1 qr = n // p root2, extra2 = gmpy2.iroot(qr,2) root2 = int(root2) q = root2 while qr % q != 0: q -= 1 r = qr // q print(\"P: {}\".format(p)) print(\"Q: {}\".format(q)) print(\"R: {}\".format(r)) phi = (p-1)*(q-1)*(r-1) d = gmpy.invert(e, phi) flag = long_to_bytes(pow(c,d,n)).decode(\"utf-8\") log.success(\"Flag: {}\".format(flag)) Output:\n$ python3 solve.py P: 139926822890670655977195962770726941986198973494425759476822219188316377933161673759394901805855617939978281385708941597117531007973713846772205166659227214187622925135931456526921198848312215276630974951050306344412865900075089120689559331322162952820292429725303619113876104177529039691490258588465409208581 Q: 139926822890670655977195962770726941986198973494425759476822219188316377933161673759394901805855617939978281385708941597117531007973713846772205166659227214187622925135931456526921198848312215276630974951050306344412865900075089120689559331322162952820292429725303619113876104177529039691490258588465409397803 R: 139926822890670655977195962770726941986198973494425759476822219188316377933161673759394901805855617939978281385708941597117531007973713846772205166659227214187622925135931456526921198848312215276630974951050306344412865900075089120689559331322162952820292429725303619113876104177529039691490258588465409494847 [+] Flag: flag{pr1m3_pr0x1m1ty_c4n_b3_v3ry_d4ng3r0u5} Flag flag{pr1m3_pr0x1m1ty_c4n_b3_v3ry_d4ng3r0u5}\n ",
  "wordCount" : "3066",
  "inLanguage": "en",
  "datePublished": "2020-06-29T14:16:00Z",
  "dateModified": "2020-06-29T14:16:00Z",
  "author":{
    "@type": "Person",
    "name": "Me"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.itsecgary.com/crypto/redpwnctf2020/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "itsecgary",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.itsecgary.com/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>
<noscript>
    <style type="text/css">
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: #1d1e20;
                --entry: #2e2e33;
                --primary: rgba(255, 255, 255, 0.84);
                --secondary: rgba(255, 255, 255, 0.56);
                --tertiary: rgba(255, 255, 255, 0.16);
                --content: rgba(255, 255, 255, 0.74);
                --hljs-bg: #2e2e33;
                --code-bg: #37383e;
                --border: #333;
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://www.itsecgary.com" accesskey="h" title="itsecgary (Alt + H)">itsecgary</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu" onscroll="menu_on_scroll()">
            <li>
                <a href="https://www.itsecgary.com/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="https://www.itsecgary.com/projects/" title="Projects">
                    <span>Projects</span>
                </a>
            </li>
            <li>
                <a href="https://www.itsecgary.com/writeups/" title="Writeups">
                    <span>Writeups</span>
                </a>
            </li>
            <li>
                <a href="https://www.itsecgary.com/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main-group">

<div class="main">
<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://www.itsecgary.com">Home</a>&nbsp;»&nbsp;<a href="https://www.itsecgary.com/crypto/">Cryptoes</a></div>
    <h1 class="post-title">
      redpwnCTF 2020 Crypto
    </h1>
    <div class="post-description">
      Writeups of crypto challenges for redpwnCTF 2020
    </div>
    <div class="post-meta">June 29, 2020&nbsp;·&nbsp;15 min&nbsp;·&nbsp;Me
</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <div class="details">Table of Contents</div>
        </summary>
        <div class="inner"><ul>
                <li>
                    <a href="#pseudo-key" aria-label="pseudo-key">pseudo-key</a><ul>
                        
                <li>
                    <a href="#writeup" aria-label="Writeup">Writeup</a></li>
                <li>
                    <a href="#flag" aria-label="Flag">Flag</a></li></ul>
                </li>
                <li>
                    <a href="#4k-rsa" aria-label="4k-rsa">4k-rsa</a><ul>
                        
                <li>
                    <a href="#writeup-1" aria-label="Writeup">Writeup</a></li>
                <li>
                    <a href="#flag-1" aria-label="Flag">Flag</a></li>
                <li>
                    <a href="#resources" aria-label="Resources">Resources</a></li></ul>
                </li>
                <li>
                    <a href="#12-shades-of-redpwn" aria-label="12-shades-of-redpwn">12-shades-of-redpwn</a><ul>
                        
                <li>
                    <a href="#writeup-2" aria-label="Writeup">Writeup</a></li>
                <li>
                    <a href="#flag-2" aria-label="Flag">Flag</a></li>
                <li>
                    <a href="#resources-1" aria-label="Resources">Resources</a></li></ul>
                </li>
                <li>
                    <a href="#itsy-bitsy" aria-label="itsy-bitsy">itsy-bitsy</a><ul>
                        
                <li>
                    <a href="#writeup-3" aria-label="Writeup">Writeup</a></li>
                <li>
                    <a href="#flag-3" aria-label="Flag">Flag</a></li>
                <li>
                    <a href="#post-note" aria-label="Post Note">Post Note</a></li></ul>
                </li>
                <li>
                    <a href="#primimity" aria-label="primimity">primimity</a><ul>
                        
                <li>
                    <a href="#writeup-4" aria-label="Writeup">Writeup</a></li>
                <li>
                    <a href="#flag-4" aria-label="Flag">Flag</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="pseudo-key">pseudo-key<a hidden class="anchor" aria-hidden="true" href="#pseudo-key">#</a></h2>
<p><strong>Category:</strong> Crypto</p>
<p><strong>Points:</strong> 341</p>
<p><strong>Description:</strong></p>
<blockquote>
<p>Keys are not always as they seem&hellip;</p>
<p><strong>Note:</strong> Make sure to wrap the plaintext with <code>flag{}</code> before you submit!</p>
<p><strong>Author:</strong> Boolean</p>
<p><strong>Given:</strong> pseudo-key-output.txt &amp;&amp; pseudo-key.py</p>
</blockquote>
<h3 id="writeup">Writeup<a hidden class="anchor" aria-hidden="true" href="#writeup">#</a></h3>
<p>First thing I do here is look at the files given to us. Looks like we are given
the ciphertext and some &ldquo;pseudo-key&rdquo;.</p>
<pre><code>Ciphertext: z_jjaoo_rljlhr_gauf_twv_shaqzb_ljtyut
Pseudo-key: iigesssaemk
</code></pre><p>From the program itself, it looks like our ciphertext is encrypted with some key, but
we are given the key encrypted with itself. Interesting&hellip;</p>
<pre><code>#!/usr/bin/env python3

from string import ascii_lowercase

chr_to_num = {c: i for i, c in enumerate(ascii_lowercase)}
num_to_chr = {i: c for i, c in enumerate(ascii_lowercase)}

def encrypt(ptxt, key):
    ptxt = ptxt.lower()
    key = ''.join(key[i % len(key)] for i in range(len(ptxt))).lower()
    ctxt = ''
    for i in range(len(ptxt)):
        if ptxt[i] == '_':
            ctxt += '_'
            continue
        x = chr_to_num[ptxt[i]]
        y = chr_to_num[key[i]]
        ctxt += num_to_chr[(x + y) % 26]
    return ctxt

with open('flag.txt') as f, open('key.txt') as k:
    flag = f.read()
    key = k.read()

ptxt = flag[5:-1]

ctxt = encrypt(ptxt,key)
pseudo_key = encrypt(key,key)

print('Ciphertext:',ctxt)
print('Pseudo-key:',pseudo_key)
</code></pre><p>The encryption method pretty much takes the alphabetical number value of each
character of the &ldquo;plaintext&rdquo;, adds it to the alphabetical number value of the key
and wraps it around if the sum is greater than 26.</p>
<p>This is where I was very twisted for a day or so. I overthought the hell out of
this problem. We realized before that the key given to us is completely wrong and is
just the result of encrypting the key with itself. I figured out that each of these
characters in the key has a total of 2 possible values it could actually be.</p>
<p>Let&rsquo;s take a look at the possible values of all 26 chars in the alphabet:</p>
<pre><code>a: (0 + 0) % 26 = 0 (a)
b: (1 + 1) % 26 = 2 (c)
c: (2 + 2) % 26 = 4 (e)
...
...
m: (12 + 12) % 26 = 24 (y)
n: (13 + 13) % 26 = 0 (a)
o: (14 + 14) % 26 = 2 (c)
p: (15 + 15) % 26 = 4 (e)
</code></pre><p>We can see here that there are really only 13 possible characters that could be
in the key. Let&rsquo;s get each possibility for our characters.</p>
<pre><code>i = e | r
i = e | r
g = d | q
e = c | p
s = j | w
s = j | w
s = j | w
a = a | n
e = c | p
m = g | t
k = f | s
</code></pre><p>Now, I&rsquo;m not sure what other people had for their approach, but I straight-up
iterated through all possible combinations of this key. There are 2^11 (2048)
key possibilities. I wrote a script to do this for me and decrypt the flag as
well. So, this will basically output 2048 different flag options. This is harder
since I don&rsquo;t have the &ldquo;flag{}&rdquo; wrapper here to help me, but oh well.</p>
<p><strong>Script:</strong></p>
<pre><code>def get_plain(ct, key):
    plain = ''
    key = ''.join(key[i % len(key)] for i in range(len(ct)))
    for i in range(len(ct)):
        if ct[i] == '_':
            plain += ct[i]
            continue
        c = ord(ct[i]) - 97
        k = ord(key[i]) - 97
        if c &gt; k:
            plain += chr(c-k+97)
        elif c &lt; k:
            plain += chr(26-k+c+97)
        else:
            plain += chr(c+97)
    return plain


psuedo_key = &quot;iigesssaemk&quot;
ct = &quot;z_jjaoo_rljlhr_gauf_twv_shaqzb_ljtyut&quot;

i = ['e', 'r']
g = ['d', 'q']
e = ['c', 'p']
s = ['j', 'w']
a = ['a', 'n']
m = ['g', 't']
k = ['f', 's']
possible_keys = []

for ii in i:
    for ii2 in i:
        for gg in g:
            for ee in e:
                for ss in s:
                    for ss2 in s:
                        for ss3 in s:
                            for aa in a:
                                for ee2 in e:
                                    for mm in m:
                                        for kk in k:
                                            test = ii + ii2 + gg + ee + ss + ss2 + ss3 + aa + ee2 + mm + kk
                                            possible_keys.append(test)

for key in possible_keys:
    plain = get_plain(ct, key)
    print(plain)
</code></pre><p>Probably a more efficient way of doing what I did, butttttt oh well.</p>
<p><strong>Output: (count)</strong></p>
<pre><code>$ python3 solve.py &gt; output &amp;&amp; wc -l output
2048 output
</code></pre><p>Scrolling through the 2048 options, I could kind of tell what some of these words
were going to be. I did a search on a pair of words to narrow down the options.</p>
<pre><code>$ cat output | grep &quot;i_guess&quot;
i_guess_pfeudo_keyf_nre_pseudb_fecure
i_guess_pfrudo_keyf_nee_pseudb_frcure
i_guess_pseudo_keyf_tre_pseudb_secure
i_guess_psrudo_keyf_tee_pseudb_srcure
i_guess_cfeudo_keyf_nre_pseudb_fecure
i_guess_cfrudo_keyf_nee_pseudb_frcure
i_guess_cseudo_keyf_tre_pseudb_secure
i_guess_csrudo_keyf_tee_pseudb_srcure
i_guess_pfeudo_keys_nre_pseudo_fecure
i_guess_pfrudo_keys_nee_pseudo_frcure
i_guess_pseudo_keys_tre_pseudo_secure
i_guess_psrudo_keys_tee_pseudo_srcure
i_guess_cfeudo_keys_nre_pseudo_fecure
i_guess_cfrudo_keys_nee_pseudo_frcure
i_guess_cseudo_keys_tre_pseudo_secure
i_guess_csrudo_keys_tee_pseudo_srcure
i_guess_pfeuqo_keyf_nre_pseudb_fechre
i_guess_pfruqo_keyf_nee_pseudb_frchre
i_guess_pseuqo_keyf_tre_pseudb_sechre
i_guess_psruqo_keyf_tee_pseudb_srchre
i_guess_cfeuqo_keyf_nre_pseudb_fechre
i_guess_cfruqo_keyf_nee_pseudb_frchre
i_guess_cseuqo_keyf_tre_pseudb_sechre
i_guess_csruqo_keyf_tee_pseudb_srchre
i_guess_pfeuqo_keys_nre_pseudo_fechre
i_guess_pfruqo_keys_nee_pseudo_frchre
i_guess_pseuqo_keys_tre_pseudo_sechre
i_guess_psruqo_keys_tee_pseudo_srchre
i_guess_cfeuqo_keys_nre_pseudo_fechre
i_guess_cfruqo_keys_nee_pseudo_frchre
i_guess_cseuqo_keys_tre_pseudo_sechre
i_guess_csruqo_keys_tee_pseudo_srchre
</code></pre><p>I&rsquo;m guessing my script had a tiny error with the &ldquo;are&rdquo; part of the flag, but it
worked.</p>
<h3 id="flag">Flag<a hidden class="anchor" aria-hidden="true" href="#flag">#</a></h3>
<p><code>flag{i_guess_pseudo_keys_are_pseudo_secure}</code></p>
<hr>
<h2 id="4k-rsa">4k-rsa<a hidden class="anchor" aria-hidden="true" href="#4k-rsa">#</a></h2>
<p><strong>Category:</strong> Crypto</p>
<p><strong>Points:</strong> 389</p>
<p><strong>Description:</strong></p>
<blockquote>
<p>Only n00bz use 2048-bit RSA. True gamers use keys that are at least 4k bits
long, no matter how many primes it takes&hellip;</p>
<p><strong>Author:</strong> Boolean</p>
<p><strong>Given:</strong> 4k-rsa-public-key.txt</p>
</blockquote>
<h3 id="writeup-1">Writeup<a hidden class="anchor" aria-hidden="true" href="#writeup-1">#</a></h3>
<p>Opening up the attachment given, we see we have a modulus <strong>(n)</strong>, public exponent
<strong>(e)</strong>, and a ciphertext <strong>(c)</strong>.</p>
<pre><code>n: 5028492424316659784848610571868499830635784588253436599431884204425304126574506051458282629520844349077718907065343861952658055912723193332988900049704385076586516440137002407618568563003151764276775720948938528351773075093802636408325577864234115127871390168096496816499360494036227508350983216047669122408034583867561383118909895952974973292619495653073541886055538702432092425858482003930575665792421982301721054750712657799039327522613062264704797422340254020326514065801221180376851065029216809710795296030568379075073865984532498070572310229403940699763425130520414160563102491810814915288755251220179858773367510455580835421154668619370583787024315600566549750956030977653030065606416521363336014610142446739352985652335981500656145027999377047563266566792989553932335258615049158885853966867137798471757467768769820421797075336546511982769835420524203920252434351263053140580327108189404503020910499228438500946012560331269890809392427093030932508389051070445428793625564099729529982492671019322403728879286539821165627370580739998221464217677185178817064155665872550466352067822943073454133105879256544996546945106521271564937390984619840428052621074566596529317714264401833493628083147272364024196348602285804117877
e: 65537
c: 3832859959626457027225709485375429656323178255126603075378663780948519393653566439532625900633433079271626752658882846798954519528892785678004898021308530304423348642816494504358742617536632005629162742485616912893249757928177819654147103963601401967984760746606313579479677305115496544265504651189209247851288266375913337224758155404252271964193376588771249685826128994580590505359435624950249807274946356672459398383788496965366601700031989073183091240557732312196619073008044278694422846488276936308964833729880247375177623028647353720525241938501891398515151145843765402243620785039625653437188509517271172952425644502621053148500664229099057389473617140142440892790010206026311228529465208203622927292280981837484316872937109663262395217006401614037278579063175500228717845448302693565927904414274956989419660185597039288048513697701561336476305496225188756278588808894723873597304279725821713301598203214138796642705887647813388102769640891356064278925539661743499697835930523006188666242622981619269625586780392541257657243483709067962183896469871277059132186393541650668579736405549322908665664807483683884964791989381083279779609467287234180135259393984011170607244611693425554675508988981095977187966503676074747171
</code></pre><p>The description provides us with a decent hint here. Saying that there are
multiple primes involved probably means that <strong>n</strong> is made from more than just
<strong>p</strong> and <strong>q</strong>!</p>
<p>There is a really nice website for factoring large <strong>n</strong> values. The website is
called <strong>FactorDB</strong> and they have a python module for the website as well.</p>
<p>Plugging our <strong>n</strong> in the website gives us a lot of primes, but the important
thing here is that it is fully factored!</p>
<pre><code>Result:
status (?)	digits	number
FF	1225 (show)	5028492424...77&lt;1225&gt; =
9353689450544968301&lt;19&gt; · 9431486459129385713&lt;19&gt; · 9563871376496945939&lt;19&gt; · 9734621099746950389&lt;19&gt; · 9736426554597289187&lt;19&gt; · 10035211751896066517&lt;20&gt; · 10040518276351167659&lt;20&gt; · 10181432127731860643&lt;20&gt; · 10207091564737615283&lt;20&gt; · 10435329529687076341&lt;20&gt; · 10498390163702844413&lt;20&gt; · 10795203922067072869&lt;20&gt; · 11172074163972443279&lt;20&gt; · 11177660664692929397&lt;20&gt; · 11485099149552071347&lt;20&gt; · 11616532426455948319&lt;20&gt; · 11964233629849590781&lt;20&gt; · 11992188644420662609&lt;20&gt; · 12084363952563914161&lt;20&gt; · 12264277362666379411&lt;20&gt; · 12284357139600907033&lt;20&gt; · 12726850839407946047&lt;20&gt; · 13115347801685269351&lt;20&gt; · 13330028326583914849&lt;20&gt; · 13447718068162387333&lt;20&gt; · 13554661643603143669&lt;20&gt; · 13558122110214876367&lt;20&gt; · 13579057804448354623&lt;20&gt; · 13716062103239551021&lt;20&gt; · 13789440402687036193&lt;20&gt; · 13856162412093479449&lt;20&gt; · 13857614679626144761&lt;20&gt; · 14296909550165083981&lt;20&gt; · 14302754311314161101&lt;20&gt; · 14636284106789671351&lt;20&gt; · 14764546515788021591&lt;20&gt; · 14893589315557698913&lt;20&gt; · 15067220807972526163&lt;20&gt; · 15241351646164982941&lt;20&gt; · 15407706505172751449&lt;20&gt; · 15524931816063806341&lt;20&gt; · 15525253577632484267&lt;20&gt; · 15549005882626828981&lt;20&gt; · 15687871802768704433&lt;20&gt; · 15720375559558820789&lt;20&gt; · 15734713257994215871&lt;20&gt; · 15742065469952258753&lt;20&gt; · 15861836139507191959&lt;20&gt; · 16136191597900016651&lt;20&gt; · 16154675571631982029&lt;20&gt; · 16175693991682950929&lt;20&gt; · 16418126406213832189&lt;20&gt; · 16568399117655835211&lt;20&gt; · 16618761350345493811&lt;20&gt; · 16663643217910267123&lt;20&gt; · 16750888032920189263&lt;20&gt; · 16796967566363355967&lt;20&gt; · 16842398522466619901&lt;20&gt; · 17472599467110501143&lt;20&gt; · 17616950931512191043&lt;20&gt; · 17825248785173311981&lt;20&gt; · 18268960885156297373&lt;20&gt; · 18311624754015021467&lt;20&gt; · 18415126952549973977&lt;20&gt;
</code></pre><p>This is easy from here on out. In order
to find our private exponent <strong>(d)</strong>, we need to find <strong>phi</strong>, which is the
product of (every prime - 1). After finding phi, we can take the modular
multiplicative inverse of <strong>e</strong> and <strong>phi</strong> to find <strong>d</strong>.</p>
<p><em>Note: I didn&rsquo;t feel like copying the 60-something primes into my script so I
used the python module for FactorDB :)</em></p>
<p><strong>Script:</strong></p>
<pre><code>import gmpy
from pwn import *
from Crypto.Util.number import long_to_bytes
import binascii
from factordb.factordb import FactorDB

n = int(open(&quot;n&quot;, &quot;r&quot;).read())
c = int(open(&quot;c&quot;, &quot;r&quot;).read())
e = 65537

f = FactorDB(n)
f.connect()
arr = f.get_factor_list()

phi = 1
for a in arr:
    phi *= (a-1)

d = gmpy.invert(e, phi)
flag = long_to_bytes(pow(c,d,n)).decode()
log.success(&quot;Flag: {}&quot;.format(flag))
</code></pre><p><strong>Output:</strong></p>
<pre><code>$ python3 4k_rsa.py
[+] Flag: flag{t0000_m4nyyyy_pr1m355555}
</code></pre><h3 id="flag-1">Flag<a hidden class="anchor" aria-hidden="true" href="#flag-1">#</a></h3>
<p><code>flag{t0000_m4nyyyy_pr1m355555}</code></p>
<h3 id="resources">Resources<a hidden class="anchor" aria-hidden="true" href="#resources">#</a></h3>
<p><a href="http://factordb.com/index.php">FactorDB</a></p>
<p><a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)">RSA Info</a></p>
<hr>
<h2 id="12-shades-of-redpwn">12-shades-of-redpwn<a hidden class="anchor" aria-hidden="true" href="#12-shades-of-redpwn">#</a></h2>
<p><strong>Category:</strong> Crypto</p>
<p><strong>Points:</strong> 429</p>
<p><strong>Description:</strong></p>
<blockquote>
<p>Everyone&rsquo;s favorite guess god Tux just sent me a flag that he somehow
encrypted with a color wheel!</p>
<p>I don&rsquo;t even know where to start, the wheel looks more like a clock than a
cipher&hellip; can you help me crack the code?</p>
<p><strong>Author:</strong> Boolean</p>
<p><strong>Given:</strong> ciphertext.jpg &amp;&amp; color-wheel.jpg</p>
</blockquote>
<h3 id="writeup-2">Writeup<a hidden class="anchor" aria-hidden="true" href="#writeup-2">#</a></h3>
<p>This one took me a while to figure out for some reason (lol). The hint gave me
the idea that the colors in the chart were corresponding to the numbers on the
clock (1-12), but I was just a tiny bit wrong. The color wheel had values
<strong>(0-11)</strong>, but in hex <em>obviously&hellip;</em> (sarcasm). Here is my edited version:</p>
<img src="color-wheel_EDITED.jpg" alt="Color Wheel">
<p>Now, with this and our ciphertext, we can start plugging and chugging values. Our
result is the following:</p>
<pre><code>86 90 81 87 a3 49 99 43 97 97 41 92 49 7b 41 97 7b 44 92 7b 44 96 98 a5
</code></pre><p>Translating this from hex to ASCII, doesn&rsquo;t give us anything but gunk&hellip;</p>
<pre><code>....¢I.C..A.I{A.{D.{D..¥
</code></pre><p>After a while of staring at this stupuid color wheel and hex values I derived from
it, I started noticing that <code>86 90 81 87</code> represents <code>flag</code> and the <code>a3</code> and
<code>a5</code> values are two apart (have to be curly braces). It finally hit me that this is
in base12. This changes our ascii representation of these values:</p>
<pre><code>41 -&gt; 1          62 -&gt; J          83 -&gt; c          a4 -&gt; |
42 -&gt; 2          63 -&gt; K          84 -&gt; d          a5 -&gt; }
43 -&gt; 3          64 -&gt; L          85 -&gt; e
44 -&gt; 4          65 -&gt; M          86 -&gt; f
45 -&gt; 5          66 -&gt; N          87 -&gt; g
46 -&gt; 6          67 -&gt; O          88 -&gt; h
47 -&gt; 7          68 -&gt; P          89 -&gt; i
48 -&gt; 8          69 -&gt; Q          8a -&gt; j
49 -&gt; 9          6a -&gt; R          8b -&gt; k
4a -&gt; :          6b -&gt; S          90 -&gt; l
4b -&gt; ;          70 -&gt; T          91 -&gt; m
50 -&gt; &lt;          71 -&gt; U          92 -&gt; n
51 -&gt; =          72 -&gt; V          93 -&gt; o
52 -&gt; &gt;          73 -&gt; W          94 -&gt; p
53 -&gt; ?          74 -&gt; X          95 -&gt; q
54 -&gt; @          75 -&gt; Y          96 -&gt; r
55 -&gt; A          76 -&gt; Z          97 -&gt; s
56 -&gt; B          77 -&gt; [          98 -&gt; t
57 -&gt; C          78 -&gt; \          99 -&gt; u
58 -&gt; D          79 -&gt; ]          9a -&gt; v
59 -&gt; E          7a -&gt; ^          9b -&gt; w
5a -&gt; F          7b -&gt; _          a0 -&gt; x
5b -&gt; G          80 -&gt; '          a1 -&gt; y
60 -&gt; H          81 -&gt; a          a2 -&gt; z
61 -&gt; I          82 -&gt; b          a3 -&gt; {
</code></pre><p>Now decoding with our base12 ASCII representation gives us the flag.</p>
<h3 id="flag-2">Flag<a hidden class="anchor" aria-hidden="true" href="#flag-2">#</a></h3>
<p><code>flag{9u3ss1n9_1s_4n_4rt}</code></p>
<h3 id="resources-1">Resources<a hidden class="anchor" aria-hidden="true" href="#resources-1">#</a></h3>
<p><a href="http://www.asciitable.com/">ASCII Chart</a></p>
<hr>
<h2 id="itsy-bitsy">itsy-bitsy<a hidden class="anchor" aria-hidden="true" href="#itsy-bitsy">#</a></h2>
<p><strong>Category:</strong> Crypto</p>
<p><strong>Points:</strong> 436</p>
<p><strong>Description:</strong></p>
<blockquote>
<p>The itsy-bitsy spider climbed up the water spout&hellip;
<code>nc 2020.redpwnc.tf 31284</code></p>
<p><strong>Author:</strong> Boolean</p>
<p><strong>Given:</strong> itsy-bitsy.py</p>
</blockquote>
<h3 id="writeup-3">Writeup<a hidden class="anchor" aria-hidden="true" href="#writeup-3">#</a></h3>
<p>This one was interesting. Don&rsquo;t really think I took the right path on this one
because I had to &ldquo;guess&rdquo; part of the flag, but you will see how I came to that.
Why write this writeup then? Because it might have been a different approach to
this problem and might be useful (maybe).</p>
<p>Anyways, I ran the program to see what we are working with:</p>
<pre><code>$ nc 2020.redpwnc.tf 31284
Enter an integer i such that i &gt; 0: 2
Enter an integer j such that j &gt; i &gt; 0: 3
Ciphertext: 0011011011001010101010101110000100000011100100010100001010101010000000111011010000100011010011100010001110100011001110011000100110110010111010010110100110001111010010100111000111010111100010101011101001000100110010000100110100101000011111001111110111000000000010010100001100100000010011110110010000010
</code></pre><p>I opened the script and analyzed the program. The general <em>function</em> of
this program was to read in two integers, and output a binary ciphertext. One of
the integers had to be bigger than the other one and they <em>both</em> had to be greater
than 0.</p>
<pre><code>#!/usr/bin/env python3

from Crypto.Random.random import randint

def str_to_bits(s):
    bit_str = ''
    for c in s:
        i = ord(c)
        bit_str += bin(i)[2:]
    return bit_str

def recv_input():
    i = input('Enter an integer i such that i &gt; 0: ')
    j = input('Enter an integer j such that j &gt; i &gt; 0: ')
    try:
        i = int(i)
        j = int(j)
        if i &lt;= 0 or j &lt;= i:
            raise Exception
    except:
        print('Error! You must adhere to the restrictions!')
        exit()
    return i,j

def generate_random_bits(lower_bound, upper_bound, number_of_bits):
    bit_str = ''
    while len(bit_str) &lt; number_of_bits:
        r = randint(lower_bound, upper_bound)
        bit_str += bin(r)[2:]
    return bit_str[:number_of_bits]

def bit_str_xor(bit_str_1, bit_str_2):
    xor_res = ''
    for i in range(len(bit_str_1)):
        bit_1 = bit_str_1[i]
        bit_2 = bit_str_2[i]
        xor_res += str(int(bit_1) ^ int(bit_2))
    return xor_res

def main():
    with open('flag.txt','r') as f:
        flag = f.read()
    for c in flag:
        i = ord(c)
        assert i in range(2**6,2**7)
    flag_bits = str_to_bits(flag)
    i,j = recv_input()
    lb = 2**i
    ub = 2**j - 1
    n = len(flag_bits)
    random_bits = generate_random_bits(lb,ub,n)
    encrypted_bits = bit_str_xor(flag_bits,random_bits)
    print(f'Ciphertext: {encrypted_bits}')

if __name__ == '__main__':
    main()
</code></pre><p>This program reads in the flag server-side and encrypts it using our numbers
we provided. The numbers we provided are put in the exponent of 2, making an
upper-bound and a lower-bound. The length of the flag is passed in to make sure
that they return the same number of bits as the flag. After generating a random
bit pattern and converting the flag into bits, the program does an XOR with both
bit streams. This is what we are seeing for the binary ciphertext given to us.
Interesting&hellip;</p>
<p>I made it certain in my head that there wasn&rsquo;t really a way to get around the
randomness of the generated bits (keep in mind I haven&rsquo;t seen any other solutions
before writing this). My approach was to take the smallest numbers I could do and
generate cases for my ciphertext.</p>
<p>If I entered in a 1 and 2. The <strong>lower-bound</strong> would be <strong>2^1</strong> and the
<strong>upper-bound</strong> would be <strong>(2^2) - 1</strong>. Making the randomly-generated bits to being
either <em>10</em> or <em>11</em> (2 &lt;= random &lt;= 3).</p>
<p>If I entered in a 2 and 3. The <strong>lower-bound</strong> would be <strong>2^2</strong> and the
<strong>upper-bound</strong> would be <strong>(2^3) - 1</strong>. Making the randomly-generated bits to being
either <em>100</em>, <em>101</em>, <em>110</em>, or <em>111</em> (4 &lt;= random &lt;= 7).</p>
<p>I started to see a pattern with this. If I chose the first option (1 and 2), every
other bit would <em>HAVE</em> to be a <strong>1</strong>. Well I guess that covers half of the bits.
I wanted more coverage, so I got samples for <strong>(1,2)</strong>, <strong>(2,3)</strong>, <strong>(4,5)</strong>,
<strong>(6,7)</strong>, <strong>(10,11)</strong>, and <strong>(12,13)</strong>. The only problem with this was all of the
prime numbers wouldn&rsquo;t be found (along with a few stragglers).</p>
<p><strong>Script:</strong></p>
<pre><code>from pwn import *
from sympy import *
from binascii import *

ctwo = &quot;0011011000011001101100001101000010010011010011100100101001011000100001011100100011110110100100010000111101000101011001011001000011010001101001010110100101001100100000010101000000010001000000011110011011100110100001010101100000101101011011011100000011010001000001110000011010010000000100010110110101000&quot;
cthree = &quot;0111101111111100011110011100010100010111110000000110011110001100110010111111110010100011010111010010011100100111011100011000000100100010101100100010110110101001000110110101010011110101110110111001001101000100010100110000110100111110101011101111010011000110010010100000011000100000110011000100010000010&quot;
cfive = &quot;0011100110010100100101000001110100101011011100110100001100001001000011001001101110111000010110010000110010110100011110101101000010000000111001110110100010100000110100110101101011100110000110010101000110000101010101100111101100000101001011101100000101010000111100000000011111111000011111110111101001000&quot;
cseven = &quot;0110001010101000001000000110010000100011110111111010100100001010110010010111100001010001111010111000000000110000000101101101100010011001000001001000010110000011000100000111110011010100011100111100011010001010010110010000011101110100011011010100001010100110111010001001010100000001000001001000110010111&quot;
celeven = &quot;0100110110100001101011011001111100100010010010010000000110011011110100010101101001000010100000000000110011111000111101101000010000000001011110111011000000000101000110011011100100101110011000010101101101101110100000101110101011101110010011000101001111011111000011000100100111110111000100000101010000100&quot;

reconstructed = ''
re_list = []
for i in range(len(ctwo)):
    if i % 2 == 0:
        val = int(ctwo[i])
        reconstructed += &quot;0&quot; if val == 1 else &quot;1&quot;
    elif i % 3 == 0:
        val = int(cthree[i])
        reconstructed += &quot;0&quot; if val == 1 else &quot;1&quot;
    elif i % 5 == 0:
        val = int(cfive[i])
        reconstructed += &quot;0&quot; if val == 1 else &quot;1&quot;
    elif i % 7 == 0:
        val = int(cseven[i])
        reconstructed += &quot;0&quot; if val == 1 else &quot;1&quot;
    elif i % 11 == 0:
        val = int(celeven[i])
        reconstructed += &quot;0&quot; if val == 1 else &quot;1&quot;
    elif isprime(i):
        reconstructed += 'p'
    else:
        reconstructed += '?'
    if len(reconstructed) == 7:
        reconstructed = &quot;0&quot; + reconstructed
        re_list.append(reconstructed)
        reconstructed = ''

print(re_list)
vals = [&quot;0&quot;, &quot;1&quot;]
flag = []
one = []
two = []
three = []
four = []
for r in re_list:
    count = 0
    for c in r:
        if c == &quot;?&quot; or c == &quot;p&quot;:
            count += 1
    if count == 0:
        one.append(r)
        two.append(r)
        three.append(r)
        four.append(r)
    elif count == 1:
        oned = r.replace(&quot;?&quot;, &quot;0&quot;).replace(&quot;p&quot;, &quot;0&quot;)
        twod = r.replace(&quot;?&quot;, &quot;1&quot;).replace(&quot;p&quot;, &quot;1&quot;)
        one.append(oned)
        two.append(twod)
        three.append(twod)
        four.append(oned)
    else:
        one.append(r.replace(&quot;p&quot;, &quot;0&quot;))
        two.append(r.replace(&quot;p&quot;, &quot;0&quot;, 1).replace(&quot;p&quot;, &quot;1&quot;, 1))
        three.append(r.replace(&quot;p&quot;, &quot;1&quot;, 1).replace(&quot;p&quot;, &quot;0&quot;, 1))
        four.append(r.replace(&quot;p&quot;, &quot;1&quot;))

flag1 = []
for h in one:
    if &quot;?&quot; in h:
        flag1.append(&quot;?&quot;)
    else:
        flag1.append(chr(int(str(h), 2)))

flag2 = []
for h in two:
    if &quot;?&quot; in h:
        flag2.append(&quot;?&quot;)
    else:
        flag2.append(chr(int(str(h), 2)))

flag3 = []
for h in three:
    if &quot;?&quot; in h:
        flag3.append(&quot;?&quot;)
    else:
        flag3.append(chr(int(str(h), 2)))

flag4 = []
for h in four:
    if &quot;?&quot; in h:
        flag4.append(&quot;?&quot;)
    else:
        flag4.append(chr(int(str(h), 2)))

print(''.join(flag1))
print(''.join(flag2))
print(''.join(flag3))
print(''.join(flag4))
</code></pre><p>Yeah&hellip;. I probably could have reduced the repetitive code, but I really didn&rsquo;t
feel like doing it at the time. Looking back at this, I probably could have
enumerated the options for the prime parts, but that is a <em>lot</em> of options.</p>
<p><strong>Output:</strong></p>
<pre><code>$ python3 itsy.py
FlagSbIpq[DdajajG_MptKdn?j_`@e_?adE?]spkU?}
fmcw[cKts_Leckcng_OqtOlo?k_dHe\x7f?ctM?_wro]?\x7f
Fligsripy[dtajizG_mtt[d~?n_p`e_?ide?]sxku?}
fmkw{skt{_luckk~g_out_l\x7f?o_the\x7f?ktm?_wzo}?\x7f
</code></pre><p>At this point, I recognized that I was pretty close. You can kind of see the flag
forming. It was just a matter of those primes because they showed up in every byte.</p>
<p>From here, all I really did was guess between the four options and see what looked
and sounded like English (yikes). Not the most impressive route, but it got me there.</p>
<h3 id="flag-3">Flag<a hidden class="anchor" aria-hidden="true" href="#flag-3">#</a></h3>
<p><code>flag{bits_leaking_out_down_the_water_spout}</code></p>
<h3 id="post-note">Post Note<a hidden class="anchor" aria-hidden="true" href="#post-note">#</a></h3>
<p>Now I&rsquo;m gonna go look at the other writeups for this challenge and realize how much time
I probably wasted in this approach lol</p>
<hr>
<h2 id="primimity">primimity<a hidden class="anchor" aria-hidden="true" href="#primimity">#</a></h2>
<p><strong>Category:</strong> Crypto</p>
<p><strong>Points:</strong> 450</p>
<p><strong>Description:</strong></p>
<blockquote>
<p>People claim that RSA with two 1024-bit primes is secure. But I trust no one.
That&rsquo;s why I use three 1024-bit primes.</p>
<p>I even created my own prime generator to be extra cautious!</p>
<p><strong>Author:</strong> Boolean</p>
<p><strong>Given:</strong> primimity.py &amp;&amp; primimity-public-key.txt</p>
</blockquote>
<h3 id="writeup-4">Writeup<a hidden class="anchor" aria-hidden="true" href="#writeup-4">#</a></h3>
<p>Looking at <strong>priminity.py</strong>, we see that the prime generation generates three
primes: <strong>p</strong>, <strong>q</strong>, and <strong>r</strong>. It picks a random 1024-bit number, then finds
the next prime - (d+1) primes away.</p>
<pre><code>#!/usr/bin/env python3

from Crypto.Util.number import getRandomNBitInteger, isPrime

def find_next_prime(n):
    if n &lt;= 1:
        return 2
    elif n == 2:
        return 3
    else:
        if n % 2 == 0:
            n += 1
        else:
            n += 2
        while not isPrime(n):
            n += 2
        return n

def prime_gen():
    i = getRandomNBitInteger(1024)
    d = getRandomNBitInteger(8)
    for _ in range(d):
        i = find_next_prime(i)
    p = find_next_prime(i)
    d = getRandomNBitInteger(8)
    for _ in range(d):
        i = find_next_prime(i)
    q = find_next_prime(i)
    d = getRandomNBitInteger(8)
    for _ in range(d):
        i = find_next_prime(i)
    r = find_next_prime(i)
    return (p,q,r)

def main():
    (p,q,r) = prime_gen()
    print(p)
    print(q)
    print(r)

if __name__ == '__main__':
    main()
</code></pre><p>Running this program once, we get an example output of:</p>
<pre><code>$ python3 primimity.py
104857957995802113202799155043146383738317717869506487255733554982237834412439876073175028008556725572257508977034962752889399455584848024999705402597044673244677421623166376772490220536819588049922242374474030586464211019488836847121605902635938292012081202316987359553541112952345050585956025016297736305427
104857957995802113202799155043146383738317717869506487255733554982237834412439876073175028008556725572257508977034962752889399455584848024999705402597044673244677421623166376772490220536819588049922242374474030586464211019488836847121605902635938292012081202316987359553541112952345050585956025016297736436659
104857957995802113202799155043146383738317717869506487255733554982237834412439876073175028008556725572257508977034962752889399455584848024999705402597044673244677421623166376772490220536819588049922242374474030586464211019488836847121605902635938292012081202316987359553541112952345050585956025016297736606427
</code></pre><p>We can spot that the difference in the primes are very small (small enough to
enumerate). Basiclaly, we are just exploiting this prime gap to find our
<strong>p</strong>, <strong>q</strong>, and <strong>r</strong>.</p>
<p><strong>Script:</strong></p>
<pre><code>from pwn import *
import gmpy2
import gmpy
from Crypto.Util.number import long_to_bytes

n = int(open(&quot;n&quot;, &quot;r&quot;).read())
c = int(open(&quot;c&quot;, &quot;r&quot;).read())
e = 65537

root, extra = gmpy2.iroot(n,3)
root = int(root)

p = root
while n % p != 0:
    p -= 1

qr = n // p
root2, extra2 = gmpy2.iroot(qr,2)
root2 = int(root2)

q = root2
while qr % q != 0:
    q -= 1

r = qr // q
print(&quot;P: {}&quot;.format(p))
print(&quot;Q: {}&quot;.format(q))
print(&quot;R: {}&quot;.format(r))

phi = (p-1)*(q-1)*(r-1)

d = gmpy.invert(e, phi)
flag = long_to_bytes(pow(c,d,n)).decode(&quot;utf-8&quot;)
log.success(&quot;Flag: {}&quot;.format(flag))
</code></pre><p><strong>Output:</strong></p>
<pre><code>$ python3 solve.py
P: 139926822890670655977195962770726941986198973494425759476822219188316377933161673759394901805855617939978281385708941597117531007973713846772205166659227214187622925135931456526921198848312215276630974951050306344412865900075089120689559331322162952820292429725303619113876104177529039691490258588465409208581
Q: 139926822890670655977195962770726941986198973494425759476822219188316377933161673759394901805855617939978281385708941597117531007973713846772205166659227214187622925135931456526921198848312215276630974951050306344412865900075089120689559331322162952820292429725303619113876104177529039691490258588465409397803
R: 139926822890670655977195962770726941986198973494425759476822219188316377933161673759394901805855617939978281385708941597117531007973713846772205166659227214187622925135931456526921198848312215276630974951050306344412865900075089120689559331322162952820292429725303619113876104177529039691490258588465409494847
[+] Flag: flag{pr1m3_pr0x1m1ty_c4n_b3_v3ry_d4ng3r0u5}
</code></pre><h3 id="flag-4">Flag<a hidden class="anchor" aria-hidden="true" href="#flag-4">#</a></h3>
<p><code>flag{pr1m3_pr0x1m1ty_c4n_b3_v3ry_d4ng3r0u5}</code></p>
<hr>

</div>
  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://www.itsecgary.com/tags/writeup/">writeup</a></li>
      <li><a href="https://www.itsecgary.com/tags/crypto/">crypto</a></li>
      <li><a href="https://www.itsecgary.com/tags/redpwnctf/">redpwnctf</a></li>
    </ul>

<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share redpwnCTF 2020 Crypto on twitter"
        href="https://twitter.com/intent/tweet/?text=redpwnCTF%202020%20Crypto&amp;url=https%3a%2f%2fwww.itsecgary.com%2fcrypto%2fredpwnctf2020%2f&amp;hashtags=writeup%2ccrypto%2credpwnctf">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share redpwnCTF 2020 Crypto on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.itsecgary.com%2fcrypto%2fredpwnctf2020%2f&amp;title=redpwnCTF%202020%20Crypto&amp;summary=redpwnCTF%202020%20Crypto&amp;source=https%3a%2f%2fwww.itsecgary.com%2fcrypto%2fredpwnctf2020%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share redpwnCTF 2020 Crypto on reddit"
        href="https://reddit.com/submit?url=https%3a%2f%2fwww.itsecgary.com%2fcrypto%2fredpwnctf2020%2f&title=redpwnCTF%202020%20Crypto">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share redpwnCTF 2020 Crypto on facebook"
        href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.itsecgary.com%2fcrypto%2fredpwnctf2020%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share redpwnCTF 2020 Crypto on whatsapp"
        href="https://api.whatsapp.com/send?text=redpwnCTF%202020%20Crypto%20-%20https%3a%2f%2fwww.itsecgary.com%2fcrypto%2fredpwnctf2020%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share redpwnCTF 2020 Crypto on telegram"
        href="https://telegram.me/share/url?text=redpwnCTF%202020%20Crypto&amp;url=https%3a%2f%2fwww.itsecgary.com%2fcrypto%2fredpwnctf2020%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>

  </footer>
</article>
</div>
    </main>
    <footer class="footer">
    <span>&copy; 2021 <a href="https://www.itsecgary.com">itsecgary</a></span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)">
    <button class="top-link" id="top-link" type="button" accesskey="g">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z" />
        </svg>
    </button>
</a>

<script>
    window.onload = function () {
        if (localStorage.getItem("menu-scroll-position")) {
            document.getElementById('menu').scrollLeft = localStorage.getItem("menu-scroll-position");
        }
    }

    function menu_on_scroll() {
        localStorage.setItem("menu-scroll-position", document.getElementById('menu').scrollLeft);
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
